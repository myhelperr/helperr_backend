{"version":3,"file":"loggerConfig.js","sources":["configs/loggerConfig.ts"],"sourceRoot":"/","sourcesContent":["import { createLogger, format, transports } from 'winston';\r\nimport path from 'path';\r\nimport fs from 'fs';\r\nimport 'winston-daily-rotate-file';\r\n\r\nconst logDir = path.join(__dirname, '../../', 'logs');\r\nif (!fs.existsSync(logDir)) {\r\n  fs.mkdirSync(logDir, { recursive: true });\r\n}\r\n\r\nconst { combine, timestamp, label, printf, colorize } = format;\r\n\r\nconst logLevels = {\r\n  levels: {\r\n    error: 0,\r\n    warn: 1,\r\n    info: 2,\r\n  },\r\n  colors: {\r\n    error: 'red',\r\n    warn: 'yellow',\r\n    info: 'green',\r\n  },\r\n};\r\n\r\nfunction logger(labelName: string) {\r\n  return createLogger({\r\n    levels: logLevels.levels,\r\n    format: combine(\r\n      label({ label: labelName }), // Helps identify where you're logging from\r\n      timestamp({ format: 'YYYY-MM-DD HH:mm:ss' }), // Timestamp format\r\n      printf(({ timestamp, level, message, label }) => {\r\n        return `[${level}] : ${timestamp} [${label}] : ${message}`;\r\n      }),\r\n    ),\r\n    transports: [\r\n      new transports.Console({\r\n        level: 'info',\r\n        format: format.combine(colorize({ all: true }), format.simple()), // colorize the console output, and show simple format\r\n      }),\r\n\r\n      new transports.DailyRotateFile({\r\n        level: 'error',\r\n        filename: 'logs/error-%DATE%.log',\r\n        datePattern: 'YYYY-MM-DD-HH',\r\n        zippedArchive: true, // Compress old log files\r\n        maxSize: '20m', // maximum size of 20MB\r\n        maxFiles: '14d', // keep log files for a total of 14 days\r\n        format: format.combine(\r\n          format.json(),\r\n          format.timestamp(),\r\n          format.prettyPrint(),\r\n        ),\r\n      }), // Log all error files to logs/error.log\r\n\r\n      new transports.DailyRotateFile({\r\n        level: 'info',\r\n        filename: 'logs/combined-%DATE%.log',\r\n        datePattern: 'YYYY-MM-DD-HH',\r\n        zippedArchive: true, // Compress old log files\r\n        maxSize: '20m', // maximum size of 20MB\r\n        maxFiles: '14d', // keep log files for a total of 14 days\r\n        format: format.combine(\r\n          format.json(),\r\n          format.timestamp(),\r\n          format.prettyPrint(),\r\n        ),\r\n      }), // Log all information files to logs/combined.log\r\n    ],\r\n  });\r\n}\r\n\r\nconst globalLog = logger('Global');\r\nconst dbLog = logger('Database');\r\nconst authLog = logger('Auth');\r\nconst mailLog = logger('Mail');\r\nconst taskLog = logger('Task');\r\n\r\n// Catch unhandled promise rejections\r\nprocess.on('unhandledRejection', (error: Error) => {\r\n  globalLog.error(`Unhandled Rejection : ${error.message || error}`);\r\n\r\n  // Shutting down the application is optional\r\n  process.exit(1);\r\n});\r\n\r\n// Catch uncaught exceptions\r\nprocess.on('uncaughtException', (error: Error) => {\r\n  globalLog.error(`Uncaught Exceptions : ${error.message || error}`);\r\n\r\n  // Shutting down the applicaiton is ooptional\r\n  process.exit(1);\r\n});\r\n\r\n// Catch warnings\r\nprocess.on('warning', (warning) => {\r\n  globalLog.warn(`Warning : ${warning.message || warning}`);\r\n});\r\n\r\nexport { globalLog, dbLog, authLog, taskLog, mailLog };\r\n"],"names":[],"mappings":"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","debug_id":"d31d8099-c9f1-577b-9ca1-df3186f06604"}