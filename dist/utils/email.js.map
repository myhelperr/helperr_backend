{"version":3,"file":"email.js","sources":["utils/email.ts"],"sourceRoot":"/","sourcesContent":["import { createTransport } from 'nodemailer';\r\nimport { EMAIL_USERNAME, EMAIL_APP_PASSWORD } from '../configs/envConfig';\r\nimport SMTPTransport from 'nodemailer/lib/smtp-transport';\r\nimport { mailLog } from '../configs/loggerConfig';\r\n\r\n// Create email transporter using Gmail service \r\nconst createEmailTransporter = () => {\r\n    return createTransport({\r\n        service: \"gmail\",\r\n        auth: {\r\n            user: EMAIL_USERNAME, // Gmail username\r\n            pass: EMAIL_APP_PASSWORD, // Gmail App Password\r\n        },\r\n        tls: {\r\n            rejectUnauthorized: false,\r\n        },\r\n        // logger: true,\r\n        debug: true,\r\n    } as SMTPTransport.Options);\r\n};\r\n\r\nexport const sendOtpEmail = async (    \r\n    name: string,\r\n    email: string,\r\n    otpCode: string\r\n) => {\r\n    const transporter = createEmailTransporter();\r\n\r\n    const mailOptions = {\r\n        from: `Kayode from Helperr <${EMAIL_USERNAME}>`,\r\n        to: email,\r\n        subject: \"Verify your Helperr account - OTP Code\",\r\n        html: `\r\n        <!DOCTYPE html>\r\n        <html lang=\"en\">\r\n        <head>\r\n            <meta charset=\"UTF-8\">\r\n            <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n            <title>Verify Your Account</title>\r\n            <style>\r\n                body {\r\n                    margin: 0;\r\n                    padding: 20px;\r\n                    font-family: Arial, sans-serif;\r\n                    background-color: #f5f5f5;\r\n                    color: #333;\r\n                }\r\n                .container {\r\n                    margin: 0 auto;\r\n                    background-color: #ffffff;\r\n                    border-radius: 8px;\r\n                    padding: 30px;\r\n                    box-shadow: 0 2px 8px rgba(0,0,0,0.1);\r\n                }\r\n                .logo {\r\n                    width: 200px;\r\n                    margin: 0 auto 20px auto;\r\n                    display: block;\r\n                }\r\n                .header {\r\n                    text-align: center;\r\n                    margin-bottom: 30px;\r\n                }\r\n                .header h1 {\r\n                    color: #6666ff;\r\n                    margin: 0;\r\n                    font-size: 24px;\r\n                }\r\n                .greeting {\r\n                    font-size: 18px;\r\n                    margin-bottom: 20px;\r\n                    text-align: center;\r\n                }\r\n                .message {\r\n                    font-size: 16px;\r\n                    line-height: 1.5;\r\n                    margin-bottom: 25px;\r\n                    text-align: center;\r\n                }\r\n                .otp-box {\r\n                    background-color: #6666ff;\r\n                    color: white;\r\n                    padding: 20px;\r\n                    border-radius: 8px;\r\n                    text-align: center;\r\n                    margin: 25px 0;\r\n                }\r\n                .otp-code {\r\n                    font-size: 28px;\r\n                    font-weight: bold;\r\n                    letter-spacing: 3px;\r\n                    margin: 0;\r\n                }\r\n                .note {\r\n                    background-color: #f8f9fa;\r\n                    padding: 15px;\r\n                    border-radius: 5px;\r\n                    font-size: 14px;\r\n                    color: #666;\r\n                    margin: 20px 0;\r\n                }\r\n                .footer {\r\n                    text-align: center;\r\n                    margin-top: 30px;\r\n                    padding-top: 20px;\r\n                    border-top: 1px solid #eee;\r\n                    color: #666;\r\n                    font-size: 14px;\r\n                }\r\n            </style>\r\n        </head>\r\n        <body>\r\n            <div class=\"container\">\r\n                <div class=\"header\">\r\n                    <img src=\"https://res.cloudinary.com/dpesanzkk/image/upload/v1757285362/my-helperr-1_xxjt9m.jpg\" \r\n                         alt=\"Helperr Logo\" class=\"logo\">\r\n                </div>\r\n                \r\n                <div class=\"greeting\">Hello ${name}!</div>\r\n                \r\n                <div class=\"message\">\r\n                    Welcome to Helperr! Please use the code below to verify your account:\r\n                </div>\r\n                \r\n                <div class=\"otp-box\">\r\n                    <div class=\"otp-code\">${otpCode}</div>\r\n                </div>\r\n                \r\n                <div class=\"note\">\r\n                    This code expires in 10 minutes. Don't share it with anyone.\r\n                </div>\r\n                \r\n                <div class=\"footer\">\r\n                    Best regards,<br>\r\n                    The Helperr Team\r\n                </div>\r\n            </div>\r\n        </body>\r\n        </html>\r\n        `,\r\n    };\r\n\r\n    try {\r\n       const info = await transporter.sendMail(mailOptions);\r\n       mailLog.info(`OTP email sent to ${email}: ${info.response}`);\r\n    } catch (error) {\r\n        mailLog.error(`Error sending OTP email to ${email}: ${error}`);\r\n    }\r\n};\r\n\r\nexport const resendOtpEmail = async (    \r\n    name: string,\r\n    email: string,\r\n    otpCode: string\r\n) => {\r\n    const transporter = createEmailTransporter();\r\n\r\n    const mailOptions = {\r\n        from: `Kayode from Helperr <${EMAIL_USERNAME}>`,\r\n        to: email,\r\n        subject: \"Resend OTP Verification Code\",\r\n        html: `\r\n        <!DOCTYPE html>\r\n        <html lang=\"en\">\r\n        <head>\r\n            <meta charset=\"UTF-8\">\r\n            <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n            <title>New Verification Code</title>\r\n            <style>\r\n                body {\r\n                    margin: 0;\r\n                    padding: 20px;\r\n                    font-family: Arial, sans-serif;\r\n                    background-color: #f5f5f5;\r\n                    color: #333;\r\n                }\r\n                .container {\r\n                    margin: 0 auto;\r\n                    background-color: #ffffff;\r\n                    border-radius: 8px;\r\n                    padding: 30px;\r\n                    box-shadow: 0 2px 8px rgba(0,0,0,0.1);\r\n                }\r\n                .logo {\r\n                    width: 200px;\r\n                    margin: 0 auto 20px auto;\r\n                    display: block;\r\n                }\r\n                .header {\r\n                    text-align: center;\r\n                    margin-bottom: 30px;\r\n                }\r\n                .header h1 {\r\n                    color: #6666ff;\r\n                    margin: 0;\r\n                    font-size: 24px;\r\n                }\r\n                .greeting {\r\n                    font-size: 18px;\r\n                    margin-bottom: 20px;\r\n                    text-align: center;\r\n                }\r\n                .message {\r\n                    font-size: 16px;\r\n                    line-height: 1.5;\r\n                    margin-bottom: 25px;\r\n                    text-align: center;\r\n                }\r\n                .otp-box {\r\n                    background-color: #6666ff;\r\n                    color: white;\r\n                    padding: 20px;\r\n                    border-radius: 8px;\r\n                    text-align: center;\r\n                    margin: 25px 0;\r\n                }\r\n                .otp-code {\r\n                    font-size: 28px;\r\n                    font-weight: bold;\r\n                    letter-spacing: 3px;\r\n                    margin: 0;\r\n                }\r\n                .note {\r\n                    background-color: #f8f9fa;\r\n                    padding: 15px;\r\n                    border-radius: 5px;\r\n                    font-size: 14px;\r\n                    color: #666;\r\n                    margin: 20px 0;\r\n                }\r\n                .footer {\r\n                    text-align: center;\r\n                    margin-top: 30px;\r\n                    padding-top: 20px;\r\n                    border-top: 1px solid #eee;\r\n                    color: #666;\r\n                    font-size: 14px;\r\n                }\r\n                .resend-notice {\r\n                    background-color: #fff3cd;\r\n                    border: 1px solid #ffeaa7;\r\n                    padding: 15px;\r\n                    border-radius: 5px;\r\n                    font-size: 14px;\r\n                    color: #856404;\r\n                    margin: 20px 0;\r\n                    text-align: center;\r\n                }\r\n            </style>\r\n        </head>\r\n        <body>\r\n            <div class=\"container\">\r\n                <div class=\"header\">\r\n                    <img src=\"https://res.cloudinary.com/dpesanzkk/image/upload/v1757285362/my-helperr-1_xxjt9m.jpg\" \r\n                         alt=\"Helperr Logo\" class=\"logo\">\r\n                </div>\r\n                \r\n                <div class=\"greeting\">Hello ${name}!</div>\r\n                \r\n                <div class=\"message\">\r\n                   🔄 This is a new verification code as requested\r\n                </div>\r\n                \r\n                <div class=\"otp-box\">\r\n                    <div class=\"otp-code\">${otpCode}</div>\r\n                </div>\r\n                \r\n                <div class=\"note\">\r\n                    This new code expires in 10 minutes and replaces any previous codes. Don't share it with anyone.\r\n                </div>\r\n                \r\n                <div class=\"footer\">\r\n                    Having trouble? Contact our support team.<br>\r\n                    Best regards,<br>\r\n                    The Helperr Team\r\n                </div>\r\n            </div>\r\n        </body>\r\n        </html>\r\n        `,\r\n    };\r\n\r\n    try {\r\n       const info = await transporter.sendMail(mailOptions);\r\n       mailLog.info(`Resend OTP email sent to ${email}: ${info.response}`);\r\n    } catch (error) {\r\n        mailLog.error(`Error sending resend OTP email to ${email}: ${error}`);\r\n    }\r\n};\r\n\r\nexport const sendPasswordResetEmail = async (name : string, email: string, otpCode: string) => {\r\n    const transporter = createEmailTransporter();\r\n\r\n    const mailOptions = {\r\n        from: `Kayode from Helperr <${EMAIL_USERNAME}>`,\r\n        to: email,\r\n        subject: \"Reset Your Helperr Password - OTP Code\",\r\n        html: `\r\n        <!DOCTYPE html>\r\n        <html lang=\"en\">\r\n        <head>\r\n            <meta charset=\"UTF-8\">\r\n            <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n            <title>Reset Your Password</title>\r\n            <style>\r\n                body {\r\n                    margin: 0;\r\n                    padding: 20px;\r\n                    font-family: Arial, sans-serif;\r\n                    background-color: #f5f5f5;\r\n                    color: #333;\r\n                }\r\n                .container {\r\n                    margin: 0 auto;\r\n                    background-color: #ffffff;\r\n                    border-radius: 8px;\r\n                    padding: 30px;\r\n                    box-shadow: 0 2px 8px rgba(0,0,0,0.1);\r\n                }\r\n                .logo {\r\n                    width: 200px;\r\n                    margin: 0 auto 20px auto;\r\n                    display: block;\r\n                }\r\n                .header {\r\n                    text-align: center;\r\n                    margin-bottom: 30px;\r\n                }\r\n                .header h1 {\r\n                    color: #6666ff;\r\n                    margin: 0;\r\n                    font-size: 24px;\r\n                }\r\n                .greeting {\r\n                    font-size: 18px;\r\n                    margin-bottom: 20px;\r\n                    text-align: center;\r\n                }\r\n                .message {\r\n                    font-size: 16px;\r\n                    line-height: 1.5;\r\n                    margin-bottom: 25px;\r\n                    text-align: center;\r\n                }\r\n                .otp-box {\r\n                    background-color: #6666ff;\r\n                    color: white;\r\n                    padding: 20px;\r\n                    border-radius: 8px;\r\n                    text-align: center;\r\n                    margin: 25px 0;\r\n                }\r\n                .otp-code {\r\n                    font-size: 28px;\r\n                    font-weight: bold;\r\n                    letter-spacing: 3px;\r\n                    margin: 0;\r\n                }\r\n                .note {\r\n                    background-color: #f8f9fa;\r\n                    padding: 15px;\r\n                    border-radius: 5px;\r\n                    font-size: 14px;\r\n                    color: #666;\r\n                    margin: 20px 0;\r\n                }\r\n                .warning {\r\n                    background-color: #fff3cd;\r\n                    border: 1px solid #ffeaa7;\r\n                    padding: 15px;\r\n                    border-radius: 5px;\r\n                    font-size: 14px;\r\n                    color: #856404;\r\n                    margin: 20px 0;\r\n                    text-align: center;\r\n                }\r\n                .footer {\r\n                    text-align: center;\r\n                    margin-top: 30px;\r\n                    padding-top: 20px;\r\n                    border-top: 1px solid #eee;\r\n                    color: #666;\r\n                    font-size: 14px;\r\n                }\r\n            </style>\r\n        </head>\r\n        <body>\r\n            <div class=\"container\">\r\n                <div class=\"header\">\r\n                    <img src=\"https://res.cloudinary.com/dpesanzkk/image/upload/v1757285362/my-helperr-1_xxjt9m.jpg\" \r\n                         alt=\"Helperr Logo\" class=\"logo\">\r\n                </div>\r\n                \r\n                <div class=\"greeting\">Hello ${name}!</div>\r\n                \r\n                <div class=\"message\">\r\n                    We received a request to reset your Helperr account password. Use the code below to proceed:\r\n                </div>\r\n                \r\n                <div class=\"otp-box\">\r\n                    <div class=\"otp-code\">${otpCode}</div>\r\n                </div>\r\n                \r\n                <div class=\"note\">\r\n                    This code expires in 10 minutes. Don't share it with anyone.\r\n                </div>\r\n                \r\n                <div class=\"warning\">\r\n                    ⚠️ If you didn't request a password reset, please ignore this email and your password will remain unchanged.\r\n                </div>\r\n                \r\n                <div class=\"footer\">\r\n                    Need help? Contact our support team.<br>\r\n                    Best regards,<br>\r\n                    The Helperr Team\r\n                </div>\r\n            </div>\r\n        </body>\r\n        </html>\r\n        `,\r\n    };\r\n\r\n    try {\r\n       const info = await transporter.sendMail(mailOptions);\r\n       mailLog.info(`Password reset OTP email sent to ${email}: ${info.response}`);\r\n    } catch (error) {\r\n        mailLog.error(`Error sending password reset email to ${email}: ${error}`);\r\n    }\r\n};"],"names":[],"mappings":"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","debug_id":"cde11614-3f8c-52f2-b42d-ce1ae4161e5f"}